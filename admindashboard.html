<!-- admin-dashboard-ultimate.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>JMPOTTERS Admin | Enterprise Management</title>
    <style>
        /* ===== CSS VARIABLES FOR PRECISE CONTROL ===== */
        :root {
            /* Color System */
            --primary-50: #EEF2FF;
            --primary-100: #E0E7FF;
            --primary-200: #C7D2FE;
            --primary-300: #A5B4FC;
            --primary-400: #818CF8;
            --primary-500: #6366F1;
            --primary-600: #4F46E5;
            --primary-700: #4338CA;
            --primary-800: #3730A3;
            --primary-900: #312E81;
            
            --success-50: #F0FDF4;
            --success-500: #22C55E;
            --success-600: #16A34A;
            --success-700: #15803D;
            
            --danger-50: #FEF2F2;
            --danger-500: #EF4444;
            --danger-600: #DC2626;
            --danger-700: #B91C1C;
            
            --warning-50: #FEFCE8;
            --warning-500: #EAB308;
            --warning-600: #CA8A04;
            --warning-700: #A16207;
            
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            
            /* Spacing System - PRECISE MOBILE OPTIMIZATION */
            --space-1: 0.25rem;   /* 4px */
            --space-2: 0.5rem;    /* 8px */
            --space-3: 0.75rem;   /* 12px */
            --space-4: 1rem;      /* 16px */
            --space-5: 1.25rem;   /* 20px */
            --space-6: 1.5rem;    /* 24px */
            --space-8: 2rem;      /* 32px */
            --space-10: 2.5rem;   /* 40px */
            --space-12: 3rem;     /* 48px */
            --space-16: 4rem;     /* 64px */
            
            /* Border Radius */
            --radius-sm: 0.375rem;  /* 6px */
            --radius: 0.5rem;       /* 8px */
            --radius-md: 0.75rem;   /* 12px */
            --radius-lg: 1rem;      /* 16px */
            --radius-xl: 1.5rem;    /* 24px */
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Layout */
            --sidebar-width: 16rem;  /* 256px */
            --header-height: 4rem;   /* 64px */
        }
        
        /* ===== CSS RESET WITH PRECISION ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-tap-highlight-color: transparent;
        }
        
        html {
            font-size: 14px;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--gray-800);
            line-height: 1.5;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* ===== MOBILE-FIRST LAYOUT ===== */
        .admin-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* ===== MOBILE HEADER ===== */
        .mobile-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-3) var(--space-4);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--gray-200);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .mobile-menu-btn {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-600);
            cursor: pointer;
        }
        
        .mobile-brand {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .brand-logo {
            width: 2rem;
            height: 2rem;
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .brand-text {
            font-weight: 700;
            font-size: 1.125rem;
            color: var(--gray-900);
        }
        
        .mobile-actions {
            display: flex;
            gap: var(--space-2);
        }
        
        /* ===== SIDEBAR FOR DESKTOP ===== */
        .admin-sidebar {
            display: none;
        }
        
        /* ===== MOBILE SIDEBAR OVERLAY ===== */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(4px);
        }
        
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            width: 85%;
            max-width: 20rem;
            background: var(--gray-900);
            z-index: 1001;
            transform: translateX(-100%);
            transition: transform var(--transition);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .mobile-sidebar.active {
            transform: translateX(0);
        }
        
        .sidebar-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--gray-800);
        }
        
        .sidebar-user {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            color: white;
        }
        
        .user-avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
        }
        
        .user-info h4 {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.125rem;
        }
        
        .user-info p {
            font-size: 0.75rem;
            color: var(--gray-400);
        }
        
        .sidebar-nav {
            flex: 1;
            padding: var(--space-4);
            overflow-y: auto;
        }
        
        .nav-section {
            margin-bottom: var(--space-6);
        }
        
        .section-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gray-400);
            margin-bottom: var(--space-2);
            padding-left: var(--space-2);
        }
        
        .nav-items {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 0.25rem;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-3);
            color: var(--gray-300);
            text-decoration: none;
            border-radius: var(--radius);
            transition: all var(--transition-fast);
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .nav-link:hover,
        .nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .nav-link.active {
            background: linear-gradient(90deg, rgba(99, 102, 241, 0.2), transparent);
            border-left: 3px solid var(--primary-500);
        }
        
        .nav-icon {
            width: 1.25rem;
            height: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .nav-badge {
            margin-left: auto;
            background: var(--primary-500);
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            min-width: 1.25rem;
            text-align: center;
        }
        
        .nav-badge.urgent {
            background: var(--danger-500);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* ===== MAIN CONTENT - MOBILE OPTIMIZED ===== */
        .admin-main {
            flex: 1;
            padding: var(--space-4);
            background: var(--gray-50);
        }
        
        /* ===== DASHBOARD SECTIONS ===== */
        .dashboard-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .dashboard-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            margin-bottom: var(--space-6);
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: var(--space-1);
            line-height: 1.2;
        }
        
        .section-subtitle {
            color: var(--gray-600);
            font-size: 0.875rem;
        }
        
        /* ===== MOBILE-OPTIMIZED STATS GRID ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .stat-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow);
            transition: all var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-3);
        }
        
        .stat-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }
        
        .stat-icon.primary {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
        }
        
        .stat-icon.success {
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
        }
        
        .stat-icon.warning {
            background: linear-gradient(135deg, var(--warning-500), var(--warning-600));
        }
        
        .stat-icon.danger {
            background: linear-gradient(135deg, var(--danger-500), var(--danger-600));
        }
        
        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: var(--gray-600);
        }
        
        /* ===== MOBILE-OPTIMIZED PRODUCTS GRID ===== */
        .products-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .product-card {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow);
            transition: all var(--transition);
        }
        
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--gray-300);
        }
        
        .product-image-container {
            width: 100%;
            height: 12rem;
            overflow: hidden;
            background: var(--gray-100);
            position: relative;
        }
        
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .product-card:hover .product-image {
            transform: scale(1.05);
        }
        
        .product-badge {
            position: absolute;
            top: var(--space-2);
            left: var(--space-2);
            padding: 0.25rem 0.75rem;
            background: rgba(0, 0, 0, 0.75);
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: var(--radius);
            backdrop-filter: blur(4px);
        }
        
        .product-content {
            padding: var(--space-4);
        }
        
        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-2);
        }
        
        .product-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            line-height: 1.3;
            flex: 1;
        }
        
        .product-category {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: var(--gray-100);
            color: var(--gray-700);
            border-radius: var(--radius);
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: var(--space-2);
        }
        
        .product-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--success-600);
            margin-bottom: var(--space-2);
        }
        
        .product-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-3);
        }
        
        .product-stock {
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius);
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .stock-high {
            background: var(--success-50);
            color: var(--success-700);
        }
        
        .stock-medium {
            background: var(--warning-50);
            color: var(--warning-700);
        }
        
        .stock-low {
            background: var(--danger-50);
            color: var(--danger-700);
        }
        
        .product-variants {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: var(--space-3);
        }
        
        .variant-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background: var(--gray-100);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            color: var(--gray-700);
        }
        
        .color-dot {
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            display: inline-block;
        }
        
        .product-actions {
            display: flex;
            gap: var(--space-2);
            padding-top: var(--space-3);
            border-top: 1px solid var(--gray-200);
        }
        
        /* ===== BUTTONS - MOBILE OPTIMIZED ===== */
        .btn {
            padding: 0.625rem 1rem;
            border: none;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-align: center;
            white-space: nowrap;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background: white;
            border: 1px solid var(--gray-300);
            color: var(--gray-700);
        }
        
        .btn-secondary:hover {
            border-color: var(--primary-500);
            color: var(--primary-600);
        }
        
        .btn-sm {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
        }
        
        .btn-block {
            width: 100%;
        }
        
        .btn-group {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-group .btn {
            flex: 1;
        }
        
        /* ===== ACTION CARDS FOR QUICK ACTIONS ===== */
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .action-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow);
            transition: all var(--transition);
        }
        
        .action-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary-500);
            box-shadow: var(--shadow-lg);
        }
        
        .action-icon {
            width: 3rem;
            height: 3rem;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            margin-bottom: var(--space-3);
        }
        
        .action-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }
        
        .action-description {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: var(--space-3);
        }
        
        /* ===== FORM CONTROLS - MOBILE OPTIMIZED ===== */
        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 0.875rem;
            transition: all var(--transition-fast);
            background: white;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }
        
        .form-label.required::after {
            content: '*';
            color: var(--danger-500);
            margin-left: 0.25rem;
        }
        
        .form-help {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: 0.25rem;
        }
        
        .form-group {
            margin-bottom: var(--space-4);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-4);
            margin-bottom: var(--space-4);
        }
        
        /* ===== MODAL SYSTEM - MOBILE OPTIMIZED ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            display: none;
            justify-content: center;
            align-items: flex-start;
            z-index: 2000;
            overflow-y: auto;
            padding: var(--space-4);
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease;
            box-shadow: var(--shadow-2xl);
        }
        
        @keyframes modalSlide {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
        }
        
        .modal-close {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: var(--radius);
            border: none;
            background: var(--gray-100);
            color: var(--gray-600);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .modal-close:hover {
            background: var(--gray-200);
            color: var(--gray-800);
        }
        
        .modal-body {
            padding: var(--space-4);
        }
        
        /* ===== COLOR MANAGEMENT SYSTEM ===== */
        .color-management {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-4);
            border: 1px solid var(--gray-200);
        }
        
        .section-title-sm {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: var(--space-3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .colors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: var(--space-3);
            margin-bottom: var(--space-3);
        }
        
        .color-item {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: var(--space-3);
            transition: all var(--transition-fast);
        }
        
        .color-item:hover {
            border-color: var(--primary-500);
            transform: translateY(-2px);
        }
        
        .color-preview {
            width: 100%;
            height: 3rem;
            border-radius: var(--radius-sm);
            margin-bottom: 0.75rem;
            border: 1px solid var(--gray-200);
        }
        
        .color-name-input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }
        
        .color-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        /* ===== SIZE MANAGEMENT SYSTEM ===== */
        .sizes-management {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-4);
            border: 1px solid var(--gray-200);
        }
        
        .sizes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: var(--space-3);
        }
        
        .size-item {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: var(--space-3);
            text-align: center;
            transition: all var(--transition-fast);
        }
        
        .size-item:hover {
            border-color: var(--primary-500);
        }
        
        .size-label {
            display: block;
            font-size: 0.75rem;
            color: var(--gray-600);
            margin-bottom: 0.25rem;
        }
        
        .size-value {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }
        
        .size-stock-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            text-align: center;
            font-size: 0.875rem;
        }
        
        /* ===== EMPTY STATES ===== */
        .empty-state {
            text-align: center;
            padding: var(--space-8) var(--space-4);
            background: white;
            border-radius: var(--radius-lg);
            border: 2px dashed var(--gray-300);
        }
        
        .empty-icon {
            width: 4rem;
            height: 4rem;
            background: var(--gray-100);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-4);
            color: var(--gray-400);
            font-size: 1.5rem;
        }
        
        .empty-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }
        
        .empty-description {
            color: var(--gray-600);
            font-size: 0.875rem;
            max-width: 24rem;
            margin: 0 auto var(--space-4);
            line-height: 1.5;
        }
        
        /* ===== LOADING STATES ===== */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-8);
            color: var(--gray-500);
            text-align: center;
        }
        
        .loading-spinner {
            width: 2.5rem;
            height: 2.5rem;
            border: 3px solid var(--gray-200);
            border-top-color: var(--primary-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: var(--space-3);
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ===== TOAST NOTIFICATIONS ===== */
        .toast-container {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 9999;
            max-width: 24rem;
        }
        
        .toast {
            background: white;
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius);
            margin-bottom: var(--space-2);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: var(--space-3);
            animation: toastSlide 0.3s ease;
            border-left: 4px solid var(--primary-500);
        }
        
        .toast.success { border-color: var(--success-500); }
        .toast.error { border-color: var(--danger-500); }
        .toast.warning { border-color: var(--warning-500); }
        
        @keyframes toastSlide {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast-icon {
            font-size: 1.25rem;
        }
        
        .toast.success .toast-icon { color: var(--success-500); }
        .toast.error .toast-icon { color: var(--danger-500); }
        .toast.warning .toast-icon { color: var(--warning-500); }
        
        /* ===== TABLET RESPONSIVE ===== */
        @media (min-width: 640px) {
            html {
                font-size: 15px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                max-width: 42rem;
            }
        }
        
        /* ===== DESKTOP RESPONSIVE ===== */
        @media (min-width: 1024px) {
            .admin-container {
                display: grid;
                grid-template-columns: var(--sidebar-width) 1fr;
                grid-template-rows: auto 1fr;
            }
            
            .mobile-header {
                display: none;
            }
            
            .admin-sidebar {
                display: block;
                grid-column: 1;
                grid-row: 1 / -1;
                background: var(--gray-900);
                color: white;
                border-right: 1px solid var(--gray-800);
                height: 100vh;
                position: sticky;
                top: 0;
                overflow-y: auto;
            }
            
            .sidebar-header {
                padding: var(--space-4);
                border-bottom: 1px solid var(--gray-800);
            }
            
            .admin-main {
                grid-column: 2;
                grid-row: 2;
                padding: var(--space-6);
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .mobile-sidebar,
            .sidebar-overlay {
                display: none !important;
            }
        }
        
        /* ===== LARGE DESKTOP ===== */
        @media (min-width: 1280px) {
            .products-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        /* ===== UTILITY CLASSES ===== */
        .hidden { display: none !important; }
        .block { display: block; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: var(--space-2); }
        .gap-3 { gap: var(--space-3); }
        .gap-4 { gap: var(--space-4); }
        .mb-2 { margin-bottom: var(--space-2); }
        .mb-3 { margin-bottom: var(--space-3); }
        .mb-4 { margin-bottom: var(--space-4); }
        .mb-6 { margin-bottom: var(--space-6); }
        .mt-2 { margin-top: var(--space-2); }
        .mt-3 { margin-top: var(--space-3); }
        .mt-4 { margin-top: var(--space-4); }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .font-semibold { font-weight: 600; }
        .text-gray-600 { color: var(--gray-600); }
        .text-gray-700 { color: var(--gray-700); }
        .w-full { width: 100%; }
        
        /* ===== SCROLLBAR STYLING ===== */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-400);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-500);
        }
    </style>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- Mobile Header -->
    <header class="mobile-header">
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="mobile-brand">
            <div class="brand-logo">
                <i class="fas fa-store"></i>
            </div>
            <span class="brand-text">JMPOTTERS</span>
        </div>
        
        <div class="mobile-actions">
            <button class="mobile-menu-btn" onclick="AdminDashboard.openAddProductModal()">
                <i class="fas fa-plus"></i>
            </button>
            <button class="mobile-menu-btn" onclick="AdminDashboard.testWrite()">
                <i class="fas fa-vial"></i>
            </button>
        </div>
    </header>
    
    <!-- Mobile Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Mobile Sidebar -->
    <aside class="mobile-sidebar" id="mobileSidebar">
        <div class="sidebar-header">
            <div class="sidebar-user">
                <div class="user-avatar">AD</div>
                <div class="user-info">
                    <h4>Admin User</h4>
                    <p>Administrator</p>
                </div>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="section-label">Main</div>
                <ul class="nav-items">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-section="dashboard">
                            <div class="nav-icon">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="analytics">
                            <div class="nav-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            Analytics
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-section">
                <div class="section-label">Commerce</div>
                <ul class="nav-items">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="products">
                            <div class="nav-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            Products
                            <div class="nav-badge" id="productsCount">0</div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="categories">
                            <div class="nav-icon">
                                <i class="fas fa-tags"></i>
                            </div>
                            Categories
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="inventory">
                            <div class="nav-icon">
                                <i class="fas fa-warehouse"></i>
                            </div>
                            Inventory
                            <div class="nav-badge urgent" id="lowStockCount">0</div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="orders">
                            <div class="nav-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            Orders
                            <div class="nav-badge" id="ordersCount">0</div>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-section">
                <div class="section-label">Marketing</div>
                <ul class="nav-items">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="coupons">
                            <div class="nav-icon">
                                <i class="fas fa-ticket-alt"></i>
                            </div>
                            Coupons
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="reviews">
                            <div class="nav-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            Reviews
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-section">
                <div class="section-label">Settings</div>
                <ul class="nav-items">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="users">
                            <div class="nav-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            Users
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="settings">
                            <div class="nav-icon">
                                <i class="fas fa-cog"></i>
                            </div>
                            Settings
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </aside>
    
    <!-- Desktop Sidebar -->
    <aside class="admin-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-user">
                <div class="user-avatar">AD</div>
                <div class="user-info">
                    <h4>Admin User</h4>
                    <p>Administrator</p>
                </div>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <!-- Same navigation as mobile sidebar -->
        </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="admin-main">
        <!-- Dashboard Section -->
        <section id="dashboard" class="dashboard-section active">
            <div class="section-header">
                <h1 class="section-title">Dashboard Overview</h1>
                <p class="section-subtitle">Welcome back! Here's what's happening with your store today.</p>
            </div>
            
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon primary">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="text-xs text-gray-600">Today</div>
                    </div>
                    <div class="stat-value" id="todayRevenue">â‚¦0</div>
                    <div class="stat-label">Today's Revenue</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon success">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="text-xs text-gray-600">Total</div>
                    </div>
                    <div class="stat-value" id="totalProductsCount">0</div>
                    <div class="stat-label">Products</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon warning">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="text-xs text-gray-600">Alert</div>
                    </div>
                    <div class="stat-value" id="lowStockCountStat">0</div>
                    <div class="stat-label">Low Stock Items</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon danger">
                            <i class="fas fa-ban"></i>
                        </div>
                        <div class="text-xs text-gray-600">Out</div>
                    </div>
                    <div class="stat-value" id="outOfStockCount">0</div>
                    <div class="stat-label">Out of Stock</div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="mb-6">
                <h2 class="section-title-sm mb-4">Quick Actions</h2>
                <div class="quick-actions">
                    <div class="action-card" onclick="AdminDashboard.openAddProductModal()">
                        <div class="action-icon">
                            <i class="fas fa-plus"></i>
                        </div>
                        <h3 class="action-title">Add Product</h3>
                        <p class="action-description">Create new product with variants</p>
                        <button class="btn btn-primary btn-block mt-3">
                            <i class="fas fa-plus"></i> Add Now
                        </button>
                    </div>
                    
                    <div class="action-card" onclick="AdminDashboard.showSection('inventory')">
                        <div class="action-icon">
                            <i class="fas fa-warehouse"></i>
                        </div>
                        <h3 class="action-title">Manage Inventory</h3>
                        <p class="action-description">Update stock levels in bulk</p>
                        <button class="btn btn-secondary btn-block mt-3">
                            <i class="fas fa-edit"></i> Manage
                        </button>
                    </div>
                    
                    <div class="action-card" onclick="AdminDashboard.testWrite()">
                        <div class="action-icon">
                            <i class="fas fa-vial"></i>
                        </div>
                        <h3 class="action-title">Test Database</h3>
                        <p class="action-description">Test Supabase connection & writes</p>
                        <button class="btn btn-secondary btn-block mt-3">
                            <i class="fas fa-bolt"></i> Test Now
                        </button>
                    </div>
                    
                    <div class="action-card" onclick="AdminDashboard.exportProducts()">
                        <div class="action-icon">
                            <i class="fas fa-file-export"></i>
                        </div>
                        <h3 class="action-title">Export Data</h3>
                        <p class="action-description">Export products to CSV/Excel</p>
                        <button class="btn btn-secondary btn-block mt-3">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Recent Products -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="section-title-sm">Recent Products</h2>
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.loadProducts()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
                <div class="products-grid" id="recentProducts">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Loading recent products...</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Products Management Section -->
        <section id="products" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Product Management</h1>
                <p class="section-subtitle">Manage your entire product catalog (368 products)</p>
            </div>
            
            <!-- Product Actions -->
            <div class="mb-6">
                <div class="flex flex-col sm:flex-row gap-4 mb-4">
                    <button class="btn btn-primary" onclick="AdminDashboard.openAddProductModal()">
                        <i class="fas fa-plus"></i> Add New Product
                    </button>
                    <div class="flex gap-2 flex-1">
                        <select class="form-control" id="categoryFilter">
                            <option value="">All Categories</option>
                        </select>
                        <input type="text" class="form-control" placeholder="Search products..." id="productSearch">
                    </div>
                </div>
                
                <div class="flex flex-wrap gap-2 mb-4">
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.filterProducts('all')">
                        All Products
                    </button>
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.filterProducts('footwear')">
                        <i class="fas fa-shoe-prints"></i> Footwear
                    </button>
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.filterProducts('low_stock')">
                        <i class="fas fa-exclamation-triangle"></i> Low Stock
                    </button>
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.filterProducts('inactive')">
                        <i class="fas fa-ban"></i> Inactive
                    </button>
                </div>
            </div>
            
            <!-- Products Grid -->
            <div class="products-grid" id="allProducts">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Loading all products from Supabase...</p>
                </div>
            </div>
            
            <!-- Pagination -->
            <div class="flex items-center justify-between mt-6" id="paginationContainer" style="display: none;">
                <div class="text-sm text-gray-600" id="paginationInfo">
                    Showing <span id="startRow">1</span>-<span id="endRow">20</span> of <span id="totalRows">0</span> products
                </div>
                <div class="flex gap-2">
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.prevPage()" id="prevBtn">
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.nextPage()" id="nextBtn">
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Inventory Management Section -->
        <section id="inventory" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Inventory Management</h1>
                <p class="section-subtitle">Track and manage stock levels across all products</p>
            </div>
            
            <!-- Inventory Stats -->
            <div class="stats-grid mb-6">
                <div class="stat-card">
                    <div class="stat-value" id="inventoryTotalStock">0</div>
                    <div class="stat-label">Total Stock Units</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value text-warning-600" id="inventoryLowStock">0</div>
                    <div class="stat-label">Low Stock Items</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value text-danger-600" id="inventoryOutOfStock">0</div>
                    <div class="stat-label">Out of Stock</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value text-success-600" id="inventoryValue">â‚¦0</div>
                    <div class="stat-label">Inventory Value</div>
                </div>
            </div>
            
            <!-- Bulk Stock Update -->
            <div class="mb-6">
                <div class="action-card">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="action-title">Bulk Stock Update</h3>
                        <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.downloadStockTemplate()">
                            <i class="fas fa-download"></i> Template
                        </button>
                    </div>
                    <p class="action-description mb-4">
                        Update multiple product stock levels at once using CSV import.
                        Download template, update stock quantities, and upload.
                    </p>
                    <div class="flex gap-2">
                        <input type="file" id="stockUpload" accept=".csv" class="hidden" onchange="AdminDashboard.handleStockUpload(event)">
                        <button class="btn btn-secondary flex-1" onclick="document.getElementById('stockUpload').click()">
                            <i class="fas fa-upload"></i> Import CSV
                        </button>
                        <button class="btn btn-primary" onclick="AdminDashboard.applyBulkStock()">
                            <i class="fas fa-check"></i> Apply Updates
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Low Stock Alerts -->
            <div class="mb-6">
                <h2 class="section-title-sm mb-4">Low Stock Alerts</h2>
                <div id="lowStockAlerts">
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3 class="empty-title">All Stock Levels Good</h3>
                        <p class="empty-description">
                            No products are currently low on stock. When stock levels drop below 10 units,
                            they will appear here for quick restocking.
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Stock History -->
            <div>
                <h2 class="section-title-sm mb-4">Recent Stock Changes</h2>
                <div id="stockHistory">
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <h3 class="empty-title">No Stock Changes Yet</h3>
                        <p class="empty-description">
                            When you update product stock levels, the changes will be logged here
                            for tracking and auditing purposes.
                        </p>
                        <button class="btn btn-secondary mt-4" onclick="AdminDashboard.showSection('products')">
                            <i class="fas fa-box"></i> Manage Products
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Orders Management Section -->
        <section id="orders" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Order Management</h1>
                <p class="section-subtitle">View and process customer orders</p>
            </div>
            
            <!-- Order Stats -->
            <div class="stats-grid mb-6">
                <div class="stat-card">
                    <div class="stat-value" id="ordersToday">0</div>
                    <div class="stat-label">Orders Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value text-success-600" id="ordersPending">0</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value text-warning-600" id="ordersProcessing">0</div>
                    <div class="stat-label">Processing</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value text-primary-600" id="ordersCompleted">0</div>
                    <div class="stat-label">Completed</div>
                </div>
            </div>
            
            <!-- Orders Table -->
            <div class="mb-6">
                <div class="action-card">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="action-title">Recent Orders</h3>
                        <div class="flex gap-2">
                            <select class="form-control text-sm" style="width: 120px;" id="orderStatusFilter">
                                <option value="">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="processing">Processing</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                            <input type="date" class="form-control text-sm" style="width: 140px;" id="orderDateFilter">
                        </div>
                    </div>
                    
                    <div id="ordersTable">
                        <div class="empty-state">
                            <div class="empty-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h3 class="empty-title">No Orders Yet</h3>
                            <p class="empty-description">
                                When customers place orders through your e-commerce store,
                                they will appear here. You'll be able to view order details,
                                update status, and process payments.
                            </p>
                            <div class="flex flex-col sm:flex-row gap-2 mt-4">
                                <button class="btn btn-secondary" onclick="AdminDashboard.createTestOrder()">
                                    <i class="fas fa-vial"></i> Create Test Order
                                </button>
                                <button class="btn btn-primary" onclick="AdminDashboard.importOrders()">
                                    <i class="fas fa-upload"></i> Import Orders
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Order Actions -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-file-invoice-dollar"></i>
                    </div>
                    <h3 class="action-title">Order Reports</h3>
                    <p class="action-description">
                        Generate detailed sales reports, export order data to CSV,
                        and analyze sales trends.
                    </p>
                    <button class="btn btn-secondary btn-block mt-3" onclick="AdminDashboard.generateOrderReport()">
                        <i class="fas fa-chart-bar"></i> Generate Report
                    </button>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <h3 class="action-title">Shipping Management</h3>
                    <p class="action-description">
                        Configure shipping options, print shipping labels,
                        and track order deliveries.
                    </p>
                    <button class="btn btn-secondary btn-block mt-3" onclick="AdminDashboard.configureShipping()">
                        <i class="fas fa-cog"></i> Configure Shipping
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Analytics Section -->
        <section id="analytics" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Sales Analytics</h1>
                <p class="section-subtitle">Track sales performance and customer insights</p>
            </div>
            
            <div class="action-card">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="action-title">Sales Dashboard</h3>
                    <div class="flex gap-2">
                        <select class="form-control text-sm" style="width: 100px;">
                            <option>Today</option>
                            <option>Week</option>
                            <option>Month</option>
                            <option>Year</option>
                        </select>
                    </div>
                </div>
                
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="empty-title">Analytics Coming Soon</h3>
                    <p class="empty-description">
                        The analytics dashboard is currently in development. When ready,
                        you'll be able to view sales trends, customer behavior, product performance,
                        and revenue analytics with interactive charts and graphs.
                    </p>
                    <div class="mt-4">
                        <h4 class="font-semibold mb-2">Planned Features:</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><i class="fas fa-chart-bar text-primary-500"></i> Sales performance charts</li>
                            <li><i class="fas fa-users text-success-500"></i> Customer acquisition metrics</li>
                            <li><i class="fas fa-box text-warning-500"></i> Product performance analysis</li>
                            <li><i class="fas fa-map-marker-alt text-danger-500"></i> Geographic sales data</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Coupons Section -->
        <section id="coupons" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Coupon Management</h1>
                <p class="section-subtitle">Create and manage discount coupons</p>
            </div>
            
            <div class="action-card">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="action-title">Active Coupons</h3>
                    <button class="btn btn-primary" onclick="AdminDashboard.createCoupon()">
                        <i class="fas fa-plus"></i> Create Coupon
                    </button>
                </div>
                
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <h3 class="empty-title">No Coupons Created</h3>
                    <p class="empty-description">
                        Create discount coupons to boost sales and attract customers.
                        You can set percentage or fixed amount discounts, usage limits,
                        and expiration dates.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-2 mt-4">
                        <button class="btn btn-primary" onclick="AdminDashboard.createCoupon()">
                            <i class="fas fa-plus"></i> Create First Coupon
                        </button>
                        <button class="btn btn-secondary" onclick="AdminDashboard.importCoupons()">
                            <i class="fas fa-upload"></i> Import Coupons
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Reviews Section -->
        <section id="reviews" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Product Reviews</h1>
                <p class="section-subtitle">Manage and respond to customer reviews</p>
            </div>
            
            <div class="action-card">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="action-title">Customer Reviews</h3>
                    <div class="flex gap-2">
                        <select class="form-control text-sm" style="width: 100px;">
                            <option>All Ratings</option>
                            <option>5 Stars</option>
                            <option>4 Stars</option>
                            <option>3 Stars</option>
                            <option>2 Stars</option>
                            <option>1 Star</option>
                        </select>
                    </div>
                </div>
                
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <h3 class="empty-title">No Reviews Yet</h3>
                    <p class="empty-description">
                        When customers leave reviews for your products, they will appear here.
                        You can approve, respond to, or moderate reviews to build trust with customers.
                    </p>
                    <div class="mt-4">
                        <h4 class="font-semibold mb-2">Review Management Features:</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><i class="fas fa-check-circle text-success-500"></i> Approve/Reject reviews</li>
                            <li><i class="fas fa-reply text-primary-500"></i> Respond to customer feedback</li>
                            <li><i class="fas fa-flag text-warning-500"></i> Flag inappropriate content</li>
                            <li><i class="fas fa-chart-bar text-info-500"></i> Review analytics</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Users Section -->
        <section id="users" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">User Management</h1>
                <p class="section-subtitle">Manage customer accounts and admin users</p>
            </div>
            
            <div class="action-card">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="action-title">User Accounts</h3>
                    <button class="btn btn-primary" onclick="AdminDashboard.createUser()">
                        <i class="fas fa-user-plus"></i> Add User
                    </button>
                </div>
                
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="empty-title">User Management</h3>
                    <p class="empty-description">
                        Manage customer accounts, view purchase history, and create admin users.
                        User authentication is handled by Supabase with secure role-based access.
                    </p>
                    <div class="mt-4">
                        <h4 class="font-semibold mb-2">Available User Types:</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="p-3 border border-gray-200 rounded-lg">
                                <div class="flex items-center gap-2 mb-1">
                                    <i class="fas fa-user text-primary-500"></i>
                                    <h5 class="font-semibold">Customers</h5>
                                </div>
                                <p class="text-xs text-gray-600">
                                    Regular customers who can browse products, place orders,
                                    and write reviews.
                                </p>
                            </div>
                            <div class="p-3 border border-gray-200 rounded-lg">
                                <div class="flex items-center gap-2 mb-1">
                                    <i class="fas fa-user-shield text-success-500"></i>
                                    <h5 class="font-semibold">Admins</h5>
                                </div>
                                <p class="text-xs text-gray-600">
                                    Administrators with full access to manage products,
                                    orders, and store settings.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Settings Section -->
        <section id="settings" class="dashboard-section">
            <div class="section-header">
                <h1 class="section-title">Store Settings</h1>
                <p class="section-subtitle">Configure your store preferences</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- General Settings -->
                <div class="action-card">
                    <h3 class="action-title mb-4">General Settings</h3>
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">Store Name</label>
                            <input type="text" class="form-control" value="JMPOTTERS" disabled>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Currency</label>
                            <select class="form-control" disabled>
                                <option>Nigerian Naira (â‚¦)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Timezone</label>
                            <select class="form-control">
                                <option>Africa/Lagos (GMT+1)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Image Configuration -->
                <div class="action-card">
                    <h3 class="action-title mb-4">Image Configuration</h3>
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">Base Image URL</label>
                            <input type="text" class="form-control" 
                                   value="https://ebuzome.github.io/JMPOTTERS/assets/images/" 
                                   readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category Paths</label>
                            <div class="text-sm text-gray-600 bg-gray-50 p-3 rounded border">
                                <pre id="categoryPaths" style="white-space: pre-wrap; font-family: monospace;"></pre>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Database Settings -->
                <div class="action-card md:col-span-2">
                    <h3 class="action-title mb-4">Database Settings</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="form-label">Supabase URL</label>
                            <input type="text" class="form-control" 
                                   value="https://tmpggeeuwdvlngvfncaa.supabase.co" readonly>
                        </div>
                        <div>
                            <label class="form-label">Connection Status</label>
                            <div class="flex items-center gap-2 mt-2">
                                <div class="w-3 h-3 rounded-full bg-green-500 animate-pulse" id="dbStatus"></div>
                                <span class="text-sm font-medium" id="dbStatusText">Connected</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button class="btn btn-secondary" onclick="AdminDashboard.testConnection()">
                            <i class="fas fa-vial"></i> Test Connection
                        </button>
                        <button class="btn btn-secondary" onclick="AdminDashboard.clearCache()">
                            <i class="fas fa-trash"></i> Clear Cache
                        </button>
                        <button class="btn btn-primary" onclick="AdminDashboard.backupDatabase()">
                            <i class="fas fa-database"></i> Backup Database
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Product Edit/Add Modal -->
    <div class="modal-overlay" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Add New Product</h2>
                <button class="modal-close" onclick="AdminDashboard.closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="productForm" onsubmit="return AdminDashboard.saveProduct(event)">
                    <input type="hidden" id="productId">
                    <input type="hidden" id="isFootwear">
                    <input type="hidden" id="currentColors" value="[]">
                    <input type="hidden" id="currentSizes" value="[]">
                    
                    <!-- Basic Information -->
                    <div class="mb-6">
                        <h3 class="section-title-sm mb-4">Basic Information</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">Product Name</label>
                                <input type="text" id="productName" class="form-control" required
                                       placeholder="Enter product name">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Price (â‚¦)</label>
                                <input type="number" id="productPrice" class="form-control" required
                                       min="0" step="100" placeholder="0">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">Category</label>
                                <select id="productCategory" class="form-control" required
                                        onchange="AdminDashboard.updateImagePreview()">
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Stock Quantity</label>
                                <input type="number" id="productStock" class="form-control"
                                       min="0" value="0" placeholder="0">
                                <div class="form-help">For non-footwear products only</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label required">Product Image</label>
                            <div class="flex gap-2 mb-2">
                                <div class="flex-1">
                                    <div class="text-sm font-medium mb-1">Image Filename</div>
                                    <input type="text" id="productImageName" class="form-control"
                                           placeholder="image-filename.jpg"
                                           oninput="AdminDashboard.updateImagePreview()">
                                </div>
                                <div class="flex-1">
                                    <div class="text-sm font-medium mb-1">Full Image URL</div>
                                    <input type="text" id="productImageUrl" class="form-control" readonly
                                           placeholder="Will be generated automatically">
                                </div>
                            </div>
                            <div class="form-help">
                                Enter only the filename (e.g., "Sleek-Heels-18500.jpg").
                                The full URL will be generated based on category.
                            </div>
                            
                            <!-- Image Preview -->
                            <div class="mt-3" id="imagePreviewContainer" style="display: none;">
                                <div class="text-sm font-medium mb-1">Image Preview</div>
                                <div class="border border-gray-300 rounded-lg p-3 bg-gray-50">
                                    <div class="flex items-center gap-3">
                                        <div class="w-16 h-16 bg-gray-200 rounded overflow-hidden flex items-center justify-center">
                                            <img id="imagePreview" src="" alt="Preview" 
                                                 class="w-full h-full object-cover" 
                                                 onerror="this.style.display='none'; document.getElementById('imagePreviewPlaceholder').style.display='block';">
                                            <div id="imagePreviewPlaceholder" class="text-gray-400">
                                                <i class="fas fa-image"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <div class="text-sm text-gray-600" id="imagePathInfo"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea id="productDescription" class="form-control" rows="3"
                                      placeholder="Enter product description..."></textarea>
                        </div>
                    </div>
                    
                    <!-- Color Management -->
                    <div class="color-management" id="colorManagementSection" style="display: none;">
                        <h3 class="section-title-sm mb-4">
                            <i class="fas fa-palette"></i> Color Variants
                            <span class="text-sm font-normal text-gray-600 ml-2" id="colorCount">(0 colors)</span>
                        </h3>
                        
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-3">
                                Manage color variants for this product. Each color can have different sizes and stock levels.
                            </p>
                            <button type="button" class="btn btn-secondary" onclick="AdminDashboard.addColor()">
                                <i class="fas fa-plus"></i> Add Color
                            </button>
                        </div>
                        
                        <div class="colors-grid" id="colorsContainer">
                            <!-- Colors will be loaded here -->
                            <div class="color-item" style="border-style: dashed; cursor: pointer; text-align: center;"
                                 onclick="AdminDashboard.addColor()">
                                <div class="color-preview" style="background: var(--gray-200); display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-plus text-gray-400" style="font-size: 1.5rem;"></i>
                                </div>
                                <div class="text-sm text-gray-600 mt-2">Add Color</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Size Management -->
                    <div class="sizes-management" id="sizeManagementSection" style="display: none;">
                        <h3 class="section-title-sm mb-4">
                            <i class="fas fa-ruler"></i> Size & Stock Management
                            <span class="text-sm font-normal text-gray-600 ml-2" id="sizeCount">(Select a color)</span>
                        </h3>
                        
                        <div class="mb-4">
                            <div class="flex items-center gap-3 mb-3">
                                <label class="form-label mb-0">Select Color:</label>
                                <select id="colorSelector" class="form-control" style="width: auto;"
                                        onchange="AdminDashboard.loadSizesForColor()">
                                    <option value="">Select a color</option>
                                </select>
                            </div>
                            <p class="text-sm text-gray-600">
                                Select a color above to manage sizes and stock levels for that specific color variant.
                            </p>
                        </div>
                        
                        <div class="sizes-grid" id="sizesContainer">
                            <!-- Sizes will be loaded here based on selected color -->
                            <div class="text-center py-8 text-gray-500">
                                <i class="fas fa-shoe-prints mb-2" style="font-size: 2rem;"></i>
                                <p>Select a color to manage sizes</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Form Actions -->
                    <div class="flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200">
                        <button type="button" class="btn btn-secondary" onclick="AdminDashboard.closeModal()">
                            Cancel
                        </button>
                        <div class="flex-1"></div>
                        <button type="button" class="btn btn-secondary" onclick="AdminDashboard.saveAsDraft()">
                            Save as Draft
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Product
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Supabase Client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <script>
        // ==================== ENTERPRISE ADMIN DASHBOARD ====================
        const AdminDashboard = (function() {
            let supabase = null;
            let categories = [];
            let products = [];
            let allProducts = []; // Store all 368+ products
            let filteredProducts = [];
            let currentPage = 1;
            let productsPerPage = 20;
            let currentFilter = 'all';
            let productColors = {}; // Store colors by product ID
            let productSizes = {}; // Store sizes by product ID
            
            // Image configuration from your architecture
            const imageConfig = {
                baseUrl: 'https://ebuzome.github.io/JMPOTTERS/assets/images/',
                paths: {
                    'mensfootwear': 'mensfootwear/',
                    'womensfootwear': '',
                    'bags': '',
                    'household': 'household2/',
                    'kids': 'kids/',
                    'accessories': 'accessories/',
                    'healthcare': ''
                }
            };
            
            // Initialize dashboard
            async function init() {
                console.log('ðŸš€ Initializing Mobile-Optimized Admin Dashboard...');
                
                try {
                    // Initialize Supabase
                    supabase = window.supabase.createClient(
                        'https://tmpggeeuwdvlngvfncaa.supabase.co',
                        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRtcGdnZWV1d2R2bG5ndmZuY2FhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxOTc0MDYsImV4cCI6MjA3Nzc3MzQwNn0.EKzkKWmzYMvQuN11vEjRTDHrUbh6dYXk7clxVsYQ0b4'
                    );
                    
                    // Setup event listeners
                    setupEventListeners();
                    
                    // Load initial data
                    await loadInitialData();
                    
                    // Update UI
                    updateDashboardStats();
                    
                    // Update category paths in settings
                    updateCategoryPaths();
                    
                    console.log('âœ… Admin Dashboard initialized successfully');
                    
                } catch (error) {
                    console.error('ðŸ’€ Initialization failed:', error);
                    showToast('Failed to initialize dashboard: ' + error.message, 'error');
                }
            }
            
            // Load all initial data
            async function loadInitialData() {
                showLoading('dashboard');
                
                try {
                    // Load categories
                    const { data: cats, error: catError } = await supabase
                        .from('categories')
                        .select('*')
                        .order('name');
                    
                    if (catError) throw catError;
                    categories = cats;
                    
                    // Load ALL products (368+)
                    console.log('ðŸ“¦ Loading all products from Supabase...');
                    const { data: allProds, error: prodError } = await supabase
                        .from('products')
                        .select(`
                            *,
                            category:categories(name, slug),
                            product_modals(modal_type)
                        `)
                        .order('created_at', { ascending: false });
                    
                    if (prodError) throw prodError;
                    
                    allProducts = allProds || [];
                    filteredProducts = [...allProducts];
                    
                    console.log(`âœ… Loaded ${allProducts.length} products from Supabase`);
                    
                    // Update counts
                    updateProductCounts();
                    
                    // Load colors for all products (batch in smaller chunks)
                    await loadProductColorsBatch();
                    
                    // Load sizes for all products (batch)
                    await loadProductSizesBatch();
                    
                    // Render initial views
                    renderRecentProducts();
                    renderProductsPage();
                    
                    // Populate category filters
                    populateCategoryFilters();
                    
                    showToast(`Loaded ${allProducts.length} products successfully`, 'success');
                    
                } catch (error) {
                    console.error('âŒ Failed to load data:', error);
                    showToast('Failed to load data: ' + error.message, 'error');
                } finally {
                    hideLoading('dashboard');
                }
            }
            
            // Load product colors in batch
            async function loadProductColorsBatch() {
                try {
                    console.log('ðŸŽ¨ Loading product colors...');
                    const { data: colors, error } = await supabase
                        .from('product_colors')
                        .select('*')
                        .order('product_id, color_name');
                    
                    if (error) throw error;
                    
                    // Group colors by product ID
                    productColors = {};
                    colors.forEach(color => {
                        if (!productColors[color.product_id]) {
                            productColors[color.product_id] = [];
                        }
                        productColors[color.product_id].push(color);
                    });
                    
                    console.log(`âœ… Loaded colors for ${Object.keys(productColors).length} products`);
                    
                } catch (error) {
                    console.error('âŒ Failed to load colors:', error);
                }
            }
            
            // Load product sizes in batch
            async function loadProductSizesBatch() {
                try {
                    console.log('ðŸ“ Loading product sizes...');
                    const { data: sizes, error } = await supabase
                        .from('product_sizes')
                        .select('*')
                        .order('product_id, color_id, size_value');
                    
                    if (error) throw error;
                    
                    // Group sizes by product ID
                    productSizes = {};
                    sizes.forEach(size => {
                        if (!productSizes[size.product_id]) {
                            productSizes[size.product_id] = [];
                        }
                        productSizes[size.product_id].push(size);
                    });
                    
                    console.log(`âœ… Loaded sizes for ${Object.keys(productSizes).length} products`);
                    
                } catch (error) {
                    console.error('âŒ Failed to load sizes:', error);
                }
            }
            
            // Update product counts
            function updateProductCounts() {
                const totalProducts = allProducts.length;
                const lowStock = allProducts.filter(p => (p.stock || 0) < 10 && (p.stock || 0) > 0).length;
                const outOfStock = allProducts.filter(p => (p.stock || 0) === 0).length;
                
                document.getElementById('productsCount').textContent = totalProducts;
                document.getElementById('lowStockCount').textContent = lowStock;
                document.getElementById('lowStockCountStat').textContent = lowStock;
                document.getElementById('outOfStockCount').textContent = outOfStock;
                document.getElementById('totalProductsCount').textContent = totalProducts;
                
                // Update inventory stats
                const totalStock = allProducts.reduce((sum, p) => sum + (p.stock || 0), 0);
                const inventoryValue = allProducts.reduce((sum, p) => sum + ((p.price || 0) * (p.stock || 0)), 0);
                
                document.getElementById('inventoryTotalStock').textContent = totalStock.toLocaleString();
                document.getElementById('inventoryLowStock').textContent = lowStock;
                document.getElementById('inventoryOutOfStock').textContent = outOfStock;
                document.getElementById('inventoryValue').textContent = 'â‚¦' + Math.round(inventoryValue).toLocaleString();
            }
            
            // Render recent products (for dashboard)
            function renderRecentProducts() {
                const container = document.getElementById('recentProducts');
                if (!container) return;
                
                const recentProducts = allProducts.slice(0, 8);
                
                if (recentProducts.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">
                                <i class="fas fa-box-open"></i>
                            </div>
                            <h3 class="empty-title">No Products Yet</h3>
                            <p class="empty-description">
                                Start by adding your first product.
                            </p>
                            <button class="btn btn-primary mt-4" onclick="AdminDashboard.openAddProductModal()">
                                <i class="fas fa-plus"></i> Add First Product
                            </button>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                
                recentProducts.forEach(product => {
                    html += renderProductCard(product);
                });
                
                container.innerHTML = html;
            }
            
            // Render product card
            function renderProductCard(product) {
                const stock = product.stock || 0;
                const stockClass = stock > 10 ? 'stock-high' : stock > 0 ? 'stock-medium' : 'stock-low';
                const stockText = stock > 10 ? `${stock} in stock` : stock > 0 ? `${stock} left` : 'Out of stock';
                const isFootwear = product.category?.slug?.includes('footwear') || 
                                  product.product_modals?.[0]?.modal_type === 'footwear';
                const colors = productColors[product.id] || [];
                const sizes = productSizes[product.id] || [];
                
                // Build image URL
                const imageUrl = product.image_url || getDefaultImageUrl(product.category?.slug);
                
                return `
                    <div class="product-card" data-product-id="${product.id}">
                        <div class="product-image-container">
                            <img src="${imageUrl}" alt="${product.name}" class="product-image"
                                 onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
                            ${!product.is_active ? `
                                <div class="product-badge" style="background: var(--danger-500);">
                                    <i class="fas fa-ban"></i> Inactive
                                </div>
                            ` : ''}
                            ${stock === 0 ? `
                                <div class="product-badge" style="background: var(--danger-600);">
                                    <i class="fas fa-times"></i> Out of Stock
                                </div>
                            ` : ''}
                        </div>
                        <div class="product-content">
                            <div class="product-header">
                                <h3 class="product-name">${product.name}</h3>
                                <span class="product-category">${product.category?.name || 'Uncategorized'}</span>
                            </div>
                            
                            <div class="product-price">â‚¦${(product.price || 0).toLocaleString()}</div>
                            
                            <div class="product-meta">
                                <div class="product-stock ${stockClass}">${stockText}</div>
                                <div class="text-xs text-gray-600">
                                    ${isFootwear ? '<i class="fas fa-shoe-prints"></i> Footwear' : '<i class="fas fa-box"></i> Product'}
                                </div>
                            </div>
                            
                            ${colors.length > 0 ? `
                                <div class="product-variants">
                                    ${colors.slice(0, 3).map(color => `
                                        <span class="variant-tag">
                                            <span class="color-dot" style="background: ${color.color_code || '#ccc'}"></span>
                                            ${color.color_name}
                                        </span>
                                    `).join('')}
                                    ${colors.length > 3 ? `<span class="variant-tag">+${colors.length - 3} more</span>` : ''}
                                </div>
                            ` : ''}
                            
                            <div class="product-actions">
                                <button class="btn btn-sm btn-primary flex-1" onclick="AdminDashboard.editProduct(${product.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.toggleProductStatus(${product.id})">
                                    <i class="fas fa-power-off"></i>
                                </button>
                                <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.duplicateProduct(${product.id})">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Render products page with pagination
            function renderProductsPage() {
                const container = document.getElementById('allProducts');
                if (!container) return;
                
                // Calculate pagination
                const startIndex = (currentPage - 1) * productsPerPage;
                const endIndex = startIndex + productsPerPage;
                const pageProducts = filteredProducts.slice(startIndex, endIndex);
                
                if (pageProducts.length === 0) {
                    let message = '';
                    switch (currentFilter) {
                        case 'low_stock':
                            message = 'No products with low stock';
                            break;
                        case 'inactive':
                            message = 'No inactive products';
                            break;
                        case 'footwear':
                            message = 'No footwear products';
                            break;
                        default:
                            message = 'No products found';
                    }
                    
                    container.innerHTML = `
                        <div class="empty-state" style="grid-column: 1 / -1;">
                            <div class="empty-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <h3 class="empty-title">${message}</h3>
                            <p class="empty-description">
                                Try changing your filters or add new products.
                            </p>
                            <button class="btn btn-primary mt-4" onclick="AdminDashboard.openAddProductModal()">
                                <i class="fas fa-plus"></i> Add New Product
                            </button>
                        </div>
                    `;
                    
                    document.getElementById('paginationContainer').style.display = 'none';
                    return;
                }
                
                let html = '';
                pageProducts.forEach(product => {
                    html += renderProductCard(product);
                });
                
                container.innerHTML = html;
                
                // Update pagination info
                const totalProducts = filteredProducts.length;
                const totalPages = Math.ceil(totalProducts / productsPerPage);
                
                document.getElementById('startRow').textContent = startIndex + 1;
                document.getElementById('endRow').textContent = Math.min(endIndex, totalProducts);
                document.getElementById('totalRows').textContent = totalProducts;
                
                // Show/hide pagination buttons
                document.getElementById('prevBtn').disabled = currentPage === 1;
                document.getElementById('nextBtn').disabled = currentPage === totalPages;
                
                document.getElementById('paginationContainer').style.display = 'flex';
            }
            
            // Filter products
            function filterProducts(filterType) {
                currentFilter = filterType;
                currentPage = 1;
                
                switch (filterType) {
                    case 'footwear':
                        filteredProducts = allProducts.filter(p => 
                            p.category?.slug?.includes('footwear') || 
                            p.product_modals?.[0]?.modal_type === 'footwear'
                        );
                        break;
                    case 'low_stock':
                        filteredProducts = allProducts.filter(p => (p.stock || 0) < 10 && (p.stock || 0) > 0);
                        break;
                    case 'inactive':
                        filteredProducts = allProducts.filter(p => !p.is_active);
                        break;
                    default:
                        filteredProducts = [...allProducts];
                }
                
                // Apply category filter if selected
                const categoryFilter = document.getElementById('categoryFilter');
                if (categoryFilter && categoryFilter.value) {
                    filteredProducts = filteredProducts.filter(p => p.category_id == categoryFilter.value);
                }
                
                // Apply search filter if entered
                const searchInput = document.getElementById('productSearch');
                if (searchInput && searchInput.value) {
                    const searchTerm = searchInput.value.toLowerCase();
                    filteredProducts = filteredProducts.filter(p => 
                        p.name.toLowerCase().includes(searchTerm) ||
                        (p.description || '').toLowerCase().includes(searchTerm)
                    );
                }
                
                renderProductsPage();
            }
            
            // Next page
            function nextPage() {
                const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderProductsPage();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }
            
            // Previous page
            function prevPage() {
                if (currentPage > 1) {
                    currentPage--;
                    renderProductsPage();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }
            
            // Populate category filters
            function populateCategoryFilters() {
                const categorySelect = document.getElementById('categoryFilter');
                const productCategory = document.getElementById('productCategory');
                
                if (categorySelect) {
                    let options = '<option value="">All Categories</option>';
                    categories.forEach(category => {
                        const productCount = allProducts.filter(p => p.category_id === category.id).length;
                        options += `<option value="${category.id}">${category.name} (${productCount})</option>`;
                    });
                    categorySelect.innerHTML = options;
                    
                    categorySelect.addEventListener('change', () => {
                        filterProducts(currentFilter);
                    });
                }
                
                if (productCategory) {
                    let options = '<option value="">Select Category</option>';
                    categories.forEach(category => {
                        options += `<option value="${category.id}" data-slug="${category.slug}">${category.name}</option>`;
                    });
                    productCategory.innerHTML = options;
                }
                
                // Setup search
                const searchInput = document.getElementById('productSearch');
                if (searchInput) {
                    searchInput.addEventListener('input', () => {
                        filterProducts(currentFilter);
                    });
                }
            }
            
            // Open add product modal
            function openAddProductModal() {
                document.getElementById('modalTitle').textContent = 'Add New Product';
                document.getElementById('productId').value = '';
                document.getElementById('isFootwear').value = 'false';
                document.getElementById('productForm').reset();
                
                // Reset variant sections
                document.getElementById('colorManagementSection').style.display = 'none';
                document.getElementById('sizeManagementSection').style.display = 'none';
                document.getElementById('colorsContainer').innerHTML = `
                    <div class="color-item" style="border-style: dashed; cursor: pointer; text-align: center;"
                         onclick="AdminDashboard.addColor()">
                        <div class="color-preview" style="background: var(--gray-200); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-plus text-gray-400" style="font-size: 1.5rem;"></i>
                        </div>
                        <div class="text-sm text-gray-600 mt-2">Add Color</div>
                    </div>
                `;
                document.getElementById('sizesContainer').innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-shoe-prints mb-2" style="font-size: 2rem;"></i>
                        <p>Select a color to manage sizes</p>
                    </div>
                `;
                
                openModal();
            }
            
            // Edit product
            async function editProduct(productId) {
                try {
                    const product = allProducts.find(p => p.id === productId);
                    if (!product) {
                        showToast('Product not found', 'error');
                        return;
                    }
                    
                    const isFootwear = product.category?.slug?.includes('footwear') || 
                                      product.product_modals?.[0]?.modal_type === 'footwear';
                    
                    // Set form values
                    document.getElementById('modalTitle').textContent = `Edit: ${product.name}`;
                    document.getElementById('productId').value = product.id;
                    document.getElementById('isFootwear').value = isFootwear;
                    document.getElementById('productName').value = product.name || '';
                    document.getElementById('productPrice').value = product.price || 0;
                    document.getElementById('productStock').value = product.stock || 0;
                    document.getElementById('productDescription').value = product.description || '';
                    
                    // Set category
                    const categorySelect = document.getElementById('productCategory');
                    if (categorySelect) {
                        categorySelect.value = product.category_id || '';
                    }
                    
                    // Parse image URL to get filename
                    const imageUrl = product.image_url || '';
                    const baseUrl = imageConfig.baseUrl;
                    let imageFilename = imageUrl;
                    
                    if (imageUrl.startsWith(baseUrl)) {
                        imageFilename = imageUrl.substring(baseUrl.length);
                        // Remove category path if present
                        const categorySlug = product.category?.slug;
                        if (categorySlug && imageConfig.paths[categorySlug]) {
                            const categoryPath = imageConfig.paths[categorySlug];
                            if (imageFilename.startsWith(categoryPath)) {
                                imageFilename = imageFilename.substring(categoryPath.length);
                            }
                        }
                    }
                    
                    document.getElementById('productImageName').value = imageFilename;
                    updateImagePreview();
                    
                    // Load colors and sizes for footwear
                    if (isFootwear) {
                        document.getElementById('colorManagementSection').style.display = 'block';
                        document.getElementById('sizeManagementSection').style.display = 'block';
                        
                        await loadColorsForProduct(productId);
                        await loadSizesForProduct(productId);
                    } else {
                        document.getElementById('colorManagementSection').style.display = 'none';
                        document.getElementById('sizeManagementSection').style.display = 'none';
                    }
                    
                    openModal();
                    
                } catch (error) {
                    console.error('Error loading product:', error);
                    showToast('Failed to load product: ' + error.message, 'error');
                }
            }
            
            // Load colors for product
            async function loadColorsForProduct(productId) {
                try {
                    const colors = productColors[productId] || [];
                    
                    const container = document.getElementById('colorsContainer');
                    if (!container) return;
                    
                    let html = '';
                    
                    if (colors.length > 0) {
                        colors.forEach(color => {
                            html += `
                                <div class="color-item" data-color-id="${color.id}">
                                    <div class="color-preview" style="background: ${color.color_code || '#ccc'}"></div>
                                    <input type="text" class="color-name-input" value="${color.color_name}"
                                           onchange="AdminDashboard.updateColorName(${color.id}, this.value)"
                                           placeholder="Color name">
                                    <div class="color-actions">
                                        <button class="btn btn-sm btn-secondary flex-1" onclick="AdminDashboard.updateColorCode(${color.id})">
                                            <i class="fas fa-palette"></i> Change
                                        </button>
                                        <button class="btn btn-sm btn-secondary" onclick="AdminDashboard.deleteColor(${color.id})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    // Add "Add Color" button
                    html += `
                        <div class="color-item" style="border-style: dashed; cursor: pointer; text-align: center;"
                             onclick="AdminDashboard.addColor()">
                            <div class="color-preview" style="background: var(--gray-200); display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-plus text-gray-400" style="font-size: 1.5rem;"></i>
                            </div>
                            <div class="text-sm text-gray-600 mt-2">Add Color</div>
                        </div>
                    `;
                    
                    container.innerHTML = html;
                    document.getElementById('colorCount').textContent = `(${colors.length} colors)`;
                    
                    // Populate color selector for sizes
                    const colorSelector = document.getElementById('colorSelector');
                    if (colorSelector) {
                        let options = '<option value="">Select a color</option>';
                        colors.forEach(color => {
                            options += `<option value="${color.id}">${color.color_name}</option>`;
                        });
                        colorSelector.innerHTML = options;
                    }
                    
                } catch (error) {
                    console.error('Error loading colors:', error);
                    showToast('Failed to load colors: ' + error.message, 'error');
                }
            }
            
            // Load sizes for product
            async function loadSizesForProduct(productId) {
                try {
                    const sizes = productSizes[productId] || [];
                    
                    // Group sizes by color
                    const sizesByColor = {};
                    sizes.forEach(size => {
                        if (!sizesByColor[size.color_id]) {
                            sizesByColor[size.color_id] = [];
                        }
                        sizesByColor[size.color_id].push(size);
                    });
                    
                    // Store sizes for later use
                    window.currentProductSizes = sizesByColor;
                    
                } catch (error) {
                    console.error('Error loading sizes:', error);
                }
            }
            
            // Load sizes for selected color
            function loadSizesForColor() {
                const colorId = document.getElementById('colorSelector').value;
                const productId = document.getElementById('productId').value;
                const sizesByColor = window.currentProductSizes || {};
                const sizes = sizesByColor[colorId] || [];
                
                const container = document.getElementById('sizesContainer');
                if (!container) return;
                
                if (!colorId) {
                    container.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-shoe-prints mb-2" style="font-size: 2rem;"></i>
                            <p>Select a color to manage sizes</p>
                        </div>
                    `;
                    return;
                }
                
                // Common shoe sizes
                const commonSizes = ['36', '37', '38', '39', '40', '41', '42', '43', '44', '45'];
                
                let html = '';
                
                commonSizes.forEach(size => {
                    const sizeData = sizes.find(s => s.size_value === size);
                    const stock = sizeData ? sizeData.stock_quantity : 0;
                    
                    html += `
                        <div class="size-item" data-size="${size}">
                            <div class="size-label">Size</div>
                            <div class="size-value">${size}</div>
                            <input type="number" class="size-stock-input" value="${stock}" 
                                   data-color-id="${colorId}" data-size="${size}"
                                   placeholder="0" min="0">
                            <div class="text-xs text-gray-600 mt-1">Current: ${stock}</div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                document.getElementById('sizeCount').textContent = `(${commonSizes.length} sizes)`;
            }
            
            // Add color
            function addColor() {
                const productId = document.getElementById('productId').value;
                if (!productId) {
                    showToast('Please save the product first before adding colors', 'warning');
                    return;
                }
                
                // In a real implementation, this would open a modal to add a new color
                showToast('Color management feature in development', 'info');
            }
            
            // Update image preview
            function updateImagePreview() {
                const categorySelect = document.getElementById('productCategory');
                const imageName = document.getElementById('productImageName').value;
                const previewContainer = document.getElementById('imagePreviewContainer');
                const previewImg = document.getElementById('imagePreview');
                const placeholder = document.getElementById('imagePreviewPlaceholder');
                const pathInfo = document.getElementById('imagePathInfo');
                
                if (!categorySelect.value || !imageName) {
                    previewContainer.style.display = 'none';
                    return;
                }
                
                const category = categories.find(c => c.id == categorySelect.value);
                if (!category) return;
                
                // Build full image URL
                const categorySlug = category.slug;
                const categoryPath = imageConfig.paths[categorySlug] || '';
                const fullUrl = imageConfig.baseUrl + categoryPath + imageName;
                
                document.getElementById('productImageUrl').value = fullUrl;
                
                // Update preview
                previewImg.src = fullUrl;
                previewImg.style.display = 'block';
                placeholder.style.display = 'none';
                
                // Show path info
                pathInfo.textContent = `Path: ${imageConfig.baseUrl}${categoryPath}${imageName}`;
                previewContainer.style.display = 'block';
            }
            
            // Get default image URL
            function getDefaultImageUrl(categorySlug) {
                const categoryPath = imageConfig.paths[categorySlug] || '';
                return imageConfig.baseUrl + categoryPath + 'placeholder.jpg';
            }
            
            // Save product
            async function saveProduct(event) {
                event.preventDefault();
                
                const productId = document.getElementById('productId').value;
                const isFootwear = document.getElementById('isFootwear').value === 'true';
                const isNew = !productId;
                
                // Get category for image path
                const categoryId = document.getElementById('productCategory').value;
                const category = categories.find(c => c.id == categoryId);
                if (!category) {
                    showToast('Please select a category', 'error');
                    return;
                }
                
                // Build image URL
                const imageName = document.getElementById('productImageName').value.trim();
                if (!imageName) {
                    showToast('Please enter an image filename', 'error');
                    return;
                }
                
                const categorySlug = category.slug;
                const categoryPath = imageConfig.paths[categorySlug] || '';
                const imageUrl = imageConfig.baseUrl + categoryPath + imageName;
                
                // Build product data
                const productData = {
                    name: document.getElementById('productName').value.trim(),
                    price: parseFloat(document.getElementById('productPrice').value) || 0,
                    category_id: parseInt(categoryId),
                    description: document.getElementById('productDescription').value.trim(),
                    image_url: imageUrl,
                    is_active: true,
                    stock: parseInt(document.getElementById('productStock').value) || 0,
                    updated_at: new Date().toISOString()
                };
                
                // Add created_at for new products
                if (isNew) {
                    productData.created_at = new Date().toISOString();
                }
                
                // Validate
                if (!productData.name || productData.price <= 0) {
                    showToast('Please fill all required fields correctly', 'warning');
                    return;
                }
                
                try {
                    console.log('ðŸ’¾ Saving product:', productData);
                    
                    let result;
                    if (isNew) {
                        // Insert new product
                        const { data, error } = await supabase
                            .from('products')
                            .insert([productData])
                            .select();
                        
                        if (error) throw error;
                        result = data[0];
                        
                        // Update product ID for color/size management
                        document.getElementById('productId').value = result.id;
                        
                    } else {
                        // Update existing product
                        const { data, error } = await supabase
                            .from('products')
                            .update(productData)
                            .eq('id', productId)
                            .select();
                        
                        if (error) throw error;
                        result = data[0];
                    }
                    
                    console.log('âœ… Product saved:', result);
                    
                    // Handle footwear variants if needed
                    if (isFootwear) {
                        await saveFootwearVariants(result.id);
                    }
                    
                    // Reload data
                    await loadInitialData();
                    
                    showToast('âœ… Product saved successfully!', 'success');
                    
                    // Close modal after success
                    setTimeout(() => {
                        closeModal();
                    }, 1500);
                    
                } catch (error) {
                    console.error('âŒ Save failed:', error);
                    showToast('âŒ Save failed: ' + error.message, 'error');
                }
            }
            
            // Save footwear variants
            async function saveFootwearVariants(productId) {
                // This is a simplified implementation
                // In production, you would save colors and sizes here
                console.log('ðŸ‘Ÿ Saving footwear variants for product:', productId);
                showToast('Footwear variant management in development', 'info');
            }
            
            // Test write operation
            async function testWrite() {
                showToast('Testing write permissions...', 'info');
                
                const testData = {
                    name: 'Write Test ' + Date.now(),
                    price: 999,
                    stock: 9,
                    category_id: 1,
                    image_url: 'https://via.placeholder.com/300',
                    description: 'Database write test',
                    is_active: true,
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                };
                
                try {
                    const { data, error } = await supabase
                        .from('products')
                        .insert([testData])
                        .select();
                    
                    if (error) throw error;
                    
                    showToast('âœ… Write test successful!', 'success');
                    
                    // Reload data
                    await loadInitialData();
                    
                } catch (error) {
                    console.error('Write test failed:', error);
                    showToast('âŒ Write test failed: ' + error.message, 'error');
                }
            }
            
            // Test connection
            async function testConnection() {
                showToast('Testing database connection...', 'info');
                
                try {
                    const { data, error } = await supabase
                        .from('products')
                        .select('count', { count: 'exact', head: true });
                    
                    if (error) throw error;
                    
                    showToast('âœ… Database connection successful!', 'success');
                    
                } catch (error) {
                    console.error('Connection test failed:', error);
                    showToast('âŒ Connection failed: ' + error.message, 'error');
                }
            }
            
            // Update category paths in settings
            function updateCategoryPaths() {
                const container = document.getElementById('categoryPaths');
                if (container) {
                    let html = '{\n';
                    for (const [category, path] of Object.entries(imageConfig.paths)) {
                        html += `  "${category}": "${path}",\n`;
                    }
                    html = html.slice(0, -2) + '\n}';
                    container.textContent = html;
                }
            }
            
            // Open modal
            function openModal() {
                document.getElementById('productModal').style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
            
            // Close modal
            function closeModal() {
                document.getElementById('productModal').style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            
            // Save as draft
            function saveAsDraft() {
                showToast('Draft saved (feature in development)', 'info');
            }
            
            // Show loading state
            function showLoading(section) {
                const container = document.getElementById(section === 'dashboard' ? 'recentProducts' : 'allProducts');
                if (container) {
                    container.innerHTML = `
                        <div class="loading" style="grid-column: 1 / -1;">
                            <div class="loading-spinner"></div>
                            <p>Loading...</p>
                        </div>
                    `;
                }
            }
            
            // Hide loading
            function hideLoading(section) {
                // Loading is removed when content is rendered
            }
            
            // Show toast notification
            function showToast(message, type = 'info') {
                const container = document.getElementById('toastContainer');
                if (!container) return;
                
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                const icon = type === 'success' ? 'check-circle' : 
                            type === 'error' ? 'exclamation-circle' : 
                            type === 'warning' ? 'exclamation-triangle' : 'info-circle';
                
                toast.innerHTML = `
                    <div class="toast-icon">
                        <i class="fas fa-${icon}"></i>
                    </div>
                    <div>${message}</div>
                `;
                
                container.appendChild(toast);
                
                // Auto remove
                setTimeout(() => {
                    toast.style.animation = 'toastSlide 0.3s ease reverse';
                    setTimeout(() => toast.remove(), 300);
                }, 5000);
            }
            
            // Setup event listeners
            function setupEventListeners() {
                // Mobile menu toggle
                const menuBtn = document.getElementById('mobileMenuBtn');
                const sidebar = document.getElementById('mobileSidebar');
                const overlay = document.getElementById('sidebarOverlay');
                
                if (menuBtn && sidebar && overlay) {
                    menuBtn.addEventListener('click', () => {
                        sidebar.classList.add('active');
                        overlay.style.display = 'block';
                    });
                    
                    overlay.addEventListener('click', () => {
                        sidebar.classList.remove('active');
                        overlay.style.display = 'none';
                    });
                    
                    // Close sidebar when clicking a nav link
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.addEventListener('click', () => {
                            sidebar.classList.remove('active');
                            overlay.style.display = 'none';
                        });
                    });
                }
                
                // Navigation
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // Update active state
                        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Show corresponding section
                        const sectionId = this.dataset.section;
                        document.querySelectorAll('.dashboard-section').forEach(s => s.classList.remove('active'));
                        document.getElementById(sectionId).classList.add('active');
                        
                        // Update URL hash
                        window.location.hash = sectionId;
                    });
                });
                
                // Listen for hash changes
                window.addEventListener('hashchange', function() {
                    const sectionId = window.location.hash.substring(1) || 'dashboard';
                    const link = document.querySelector(`.nav-link[data-section="${sectionId}"]`);
                    if (link) link.click();
                });
                
                // Initialize from hash
                if (window.location.hash) {
                    const sectionId = window.location.hash.substring(1);
                    const link = document.querySelector(`.nav-link[data-section="${sectionId}"]`);
                    if (link) link.click();
                }
            }
            
            // Public API
            return {
                init,
                openAddProductModal,
                editProduct,
                saveProduct,
                testWrite,
                testConnection,
                closeModal,
                saveAsDraft,
                addColor,
                loadColorsForProduct,
                loadSizesForColor,
                updateImagePreview,
                filterProducts,
                nextPage,
                prevPage,
                loadProducts: loadInitialData,
                showSection: function(sectionId) {
                    const link = document.querySelector(`.nav-link[data-section="${sectionId}"]`);
                    if (link) link.click();
                }
            };
        })();
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            AdminDashboard.init();
        });
        
        // Make AdminDashboard globally available
        window.AdminDashboard = AdminDashboard;
    </script>
</body>
</html>
